# System Testing Report for Pyinstrument
## Test Scope and Coverage
### TC-E2E-001
This system level test validate the main end to end workflow of the ```pyinstrument``` profiling tool.
- Execute a Python script through the Command Line Interface (CLI) using ```pyinstrument```
- Generate an HTML report showing function calls and execution times
- Display accurate program output and profiling summary

The test simulate real user interaction with public CLI interface, ensuring that core profiling functionality and output generation behave as expected

### TC-E2E-XXX
### TC-E2E-003
This system-level test validates the main end-to-end workflow of the ```pyinstrument``` profiling tool when using the JSON UI renderer.
- Executes a Python script through the Command Line Interface (CLI) using ```pyinstrument```
- Generates a JSON profiling report using the --renderer json option
- Produces a valid JSON output, containing the required fields: ```root_frame```, ```duration```, ```samples```, and ```frames```
  
The test simulates real user interaction with PyInstrument’s public CLI interface, ensuring that the core profiling workflow and JSON output generation function as expected from a black-box perspective.

## Test Case Summary
### Test ID
TC-E2E-001
### Title
Profiling a simple Python script via CLI
### Pre conditions
Create a simple script with working Python code (test_script.py)
### Test steps
1. Open de terminal in courseProjectDocs/System-Testing/TC-E2E-001
2. Run ```pyinstrument test_script.py -o report.html```
3. Verify that report.html was generated
4. Open the report in the browser
### Expected results
- report.html is created in the current directory
- The HTML reports shows profiling data with function ranmes and execution times

### Test ID
TC-E2E-002
### Title
PyInstrument fails to generate HTML output file when using the -o flag

### Pre conditions
PyInstrument 5.1.1 installed in a Python virtual environment on a mac, terminal is open, venv is activated, and the script.py exists in the directory.

### Test steps
1. Open the terminal in courseProjectDocs/System-Testing/TC-E2E-001
2. Run ```pyinstrument test_script.py -o report.html```
3. Wait for PyInstrument to complete execution and print the profiling summary.
4. List the directory contents
5. Look for the file "report.html"

### Expected results
- A file named report.html should appear in the directory
- The file should contain the HTML-formatted profiling report generated by PyInstrument
- Running ls -al should show the script and the report file

### Execution and Actual Results
- The command executed successfully and produced a full profiling summary in the terminal, indicating that PyInstrument itself ran without crashing
- Despite providing a valid output flag (-o report.html), no file was generated in the directory; running ls -al after execution showed only script.py and the folder contents that existed prior to the test
- The profiler collected multiple samples (Samples: 2), confirming that the script ran long enough for a complete profiling session
- No error message or warning was displayed by PyInstrument— (this was a silent failure where the output step simply did not occur)
- The failure was reproducible across multiple attempts and with different file names and renderer options (like JSON mode)
- The system performed consistently in this failure mode and accross python versions, indicating a likely environmental or compatibility issue

### Failure Theories
- Apple Silicon Compatibility Issue: PyInstrument uses lower-level system calls for sampling CPU activity; some Python libraries behave differently on ARM-based Apple Silicon (M1/M2/M3), potentially affecting file-writing callbacks or how the profiler flushes profile data at shutdown
- PyInstrument Internal Bug: PyInstrument may contain an undiscovered issue where, on certain environments, it falls back to printing output to the terminal when the file-writing portion fails but does not raise a visible exception
- macOS Directory Protection: macOS sometimes applies silent restrictions in certain directories—especially inside iCloud-synced folders or protected system paths; if the script is running inside a restricted path, PyInstrument may fail to write files without showing an OS error

### Test ID
TC-E2E-003
### Title
End-to-End Validation of PyInstrument JSON UI Renderer
### Pre conditions
- PyInstrument is installed and accessible through the CLI (either via WSL or Windows).
- A valid Python script exists at the test path (e.g., test_script.py).
- The tester has permission to execute commands and write output files.
- The environment uses a supported Python version (3.8+).
### Test steps
In WSL, run the following command: ```python3 -m pyinstrument --renderer json "/mnt/c/Users/.../test_script.py" > output.json```

### Expected results
The output.json is created and contains valid JSON.

### Execution and Results
- The JSON UI test command successfully executed using the PyInstrument CLI with no errors or warnings.
- The output file output.json was made without issues.
- Parsing the JSON shows that the file structure was valid and contained all required top-level fields: ```"root_frame"```,```"duration"```, ```"samples"```, and ```"frames"```

## Group Contributions
- Jose: Designed and executed the CLI end to end profiling test case (TC-E2E-001). Documented results, verified HTML output generation and identified the correct report generation method
- Ursula: Did TC-E2E-001 and the error report 
- Michael: Designed the JSON UI end-to-end system test, along with executing the test in the development environment.
